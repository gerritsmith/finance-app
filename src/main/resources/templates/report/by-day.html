<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org/">
<head th:replace="fragments :: head"></head>
<body>
<header th:replace="fragments :: header"></header>

<div class="container" th:object="${reportByDayDTO}">
    <h1>Report By Day</h1>

    <div class="row">
        <div class="col-md-6">
            <form id="choose-dependent-variable" class="card p-3 bg-light" th:object="${dataToPlot}">
                <div class="form-group">
                    <label for="columnName">Quantity To Plot:</label>
                    <select id="columnName" class="form-control" onchange="checkValidChoices();">
                        <option th:each="columnName : *{columnNames}"
                                th:value="${columnName}"
                                th:text="*{columnDisplayNames[__${columnName}__]}">Numeric Quantity</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="denominatorName">Average Rate With Respect To:</label>
                    <select id="denominatorName" class="form-control" onchange="checkValidChoices();">
                        <option th:each="denominatorName : *{denominatorNames}"
                                th:value="${denominatorName}"
                                th:text="*{denominatorDisplayNames[__${denominatorName}__]}">Per Quantity</option>
                    </select>
                </div>
            </form>
        </div>
        <div class="col-md-6">
            <div id="line-plot" class="m-3"></div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-6">
            <div id="histogram" class="m-3"></div>
        </div>
        <div class="col-md-6">
            <div id="bar-plot" class="m-3"></div>
        </div>
    </div>

    <table class="table table-dark table-striped">
        <thead>
            <tr>
                <th>Date</th>
                <th>Deliveries</th>
                <th>Revenue</th>
                <th>Hours</th>
                <th>Miles</th>
                <th>Details</th>
            </tr>
        </thead>
        <tbody>
            <tr th:each="dayReport : *{temporalReports}" th:object="${dayReport}">
                <td th:text="*{#temporals.format(temporal,'MMM dd')}">MMM dd</td>
                <td th:text="*{deliveryCount}">948</td>
                <td th:text="*{#numbers.formatCurrency(totalRevenue)}">$54.63</td>
                <td th:text="*{totalShiftHoursString}">H hr MM min</td>
                <td th:text="*{#numbers.formatDecimal(totalShiftMiles,1,1)}">35.8</td>
                <td><a th:href="@{/reports/by-day(date=*{temporal})}"
                       class="btn btn-sm btn-info">View</a></td>
            </tr>
        </tbody>
    </table>

</div>

<footer th:replace="fragments :: footer"></footer>
<footer>
    <!--  D3 data visualization library  -->
<!--    <script src="https://d3js.org/d3.v5.min.js"></script>-->
    <script th:src="@{/js/external/d3/d3.js}"></script>

    <!--  Make Visualization  -->
    <script th:src="@{/js/graph.js}"></script>
    <script th:inline="javascript">
        let dataTable = [[${dataToPlot.data}]];
        dataTable.columnDisplayNames = [[${dataToPlot.columnDisplayNames}]];
        dataTable.denominatorDisplayNames = [[${dataToPlot.denominatorDisplayNames}]];
        selectDataColumnAndDrawCharts();
    </script>
</footer>
</body>
</html>
